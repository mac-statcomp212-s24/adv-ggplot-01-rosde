---
title: "Advanced visualization with ggplot2"
subtitle: "Challenge 1"
author: "Emanuel Deleon Otazu"
format: 
  html:
    self-contained: true
---

# Instructions

**Task:** Using `ggplot2` and other tools in R, recreate the original New York Times graphic to the greatest extent possible. Try to get as close as possible to the figure below:

![](https://lmyint.github.io/212_spring_2024/images/hw1_goal.png){width=600, fig-align="center"}

You will need to use reference pages and documentation to discover necessary tools. For example, you may want to Google search "ggplot multiple plots". When looking through results, check publication dates and use newer references.

**Requirements for passing:**

- Temperature graph
    -  Bands for the record, normal, and actual highs and lows are shown in the correct colors. 
    - Downward triangles point to the record high temperatures above the red band.
    - Text displays the record high temperatures above the triangles.
    - X-axis label: 3-letter month abbreviations appear in the middle of each month.
    - Y-axis label: Tick marks at 0, 40, 80, and 120 only.
    - Vertical lines separate the months.
    - Title of "Temperature" is included.
- Precipitation
    - Tan area and blue line reflecting the monthly cumulative precipitation is included.
    - Text (number) for cumulative precipitation for each month is included at the end of each month just above the blue line.
    - Downward triangles point to the record precipitation days.
    - Vertical lines separate the months.
    - Title of "Precipitation" is included.
- Overall
    - Both the temperature and precipitation graphs are in one figure.
    - The temperature plot takes up more vertical space than the precipitation plot.
    - The title "SFO weather in 2011" is present.

**Extra:** If you'd like further practice, recreate the legend in the temperature graph that shows how the colored lines relate to record, normal, and actual highs.

**Submission:** Click the "Render" button in RStudio to knit a self-contained HTML with all images embedded. Commit and push changes to this file as well as the generated HTML. Push your changes to GitHub by midnight on Monday 1/29. (GitHub classroom automatically creates a pull request for receiving feedback.)



# Setup

```{r}
# Code for loading packages and reading in data
library(tidyverse)
library(ggrepel)
library(ggthemes)
library(ggpubr)
weather <- read_csv("https://lmyint.github.io/212_spring_2024/data/sfo_weather.csv")
```



# Visualization

```{r}
#Wrangling 

month_starts <- weather %>% 
  filter(Day==1, Month != 1)

month_m <- weather %>%
  filter(Day ==15 ) %>%
  pull(dateInYear)

recordHighOnly <-  weather %>%
  filter(RecordP) 

recordHighOnlyT <-  weather %>%
  filter(Record) 

recordHighOnlyP <-  weather %>%
  filter(Day == 28) 


```



```{r}
# Code for recreating the visualization (Temperature)

temp <-  ggplot(weather) +
  geom_linerange(aes(x= dateInYear, ymin = RecordLow, ymax= RecordHigh  ), color= "#ECEBE3")+
  geom_linerange(aes(x= dateInYear, ymin = NormalLow, ymax= NormalHigh ), color= "#C8B8BA")+
  geom_linerange(aes(x= dateInYear, ymin = Low, ymax= High ), color= "#A90248")+
  geom_vline(data= month_starts, mapping = aes(xintercept = dateInYear ),lty= "dashed")+
  # geom_label_repel(aes(x=dateInYear, y=RecordHigh, label= RecordText ))+
  geom_text_repel(aes(x=dateInYear, y= RecordHigh, label= RecordText, check_overlap= TRUE))+
  geom_point(data =recordHighOnlyT, aes(x= dateInYear, y= RecordHigh),shape= 25, fill= "black")+
  scale_x_continuous(labels = month.abb ,breaks = month_m)+
  scale_y_continuous(breaks = c(0, 40, 80, 120))+
  theme_clean()+
  labs(title = "Temperature",
       x= "",
       y= "")
 
  
```

```{r}
# Code for recreating the visualization (Precipitation)
Precip <- weather %>% 
  ggplot(aes(x = dateInYear, y = CulmPrec ))+
  geom_line(aes(x = dateInYear, y = CulmPrec), color= "#32a3d8")+
  geom_area(fill= "#ebeae2")+
  geom_vline(data= month_starts, mapping = aes(xintercept = dateInYear),color= "grey")+
  geom_point(data =recordHighOnly,aes(x= dateInYear,y=CulmPrec ),shape= 25,fill= "black")+
  geom_text_repel(data=recordHighOnlyP, aes(x=dateInYear, y= CulmPrec, label= CulmPrec,
                                          check_overlap= TRUE))+
  labs(title = "Precipitation",
       x= "",
       y="")+
  theme_clean()
```

```{r}
#Final Graph, Temperature and Precipitation 
tempPrecip <- ggarrange(temp, Precip, ncol = 1, nrow = 2, heights = c(2, 1))
  annotate_figure(tempPrecip, top  = "SFO weather in 2011 ")
```

# AI usage

If you use an AI tool (e.g., ChatGPT, Google Bard) to help with this assignment, please paste below the prompts you use and their associated output.

**Prompt:** I have a geom_linerange graph, and I have a variable with record values, how do i make these record values to appear as text on my geom_linerange graph?



**Output:** 

"To add text labels for record values on a geom_linerange plot in ggplot2, you can use the geom_text layer. Here's an example with a modification to include record values as text labels:

- Assuming you have a variable with record values
record_values <- c(25, 30, 35)  # Replace this with your actual record values

- Create the plot with custom y-axis breaks and text label for record values
ggplot(df, aes(x = Date, ymin = 0, ymax = Temperature)) +
  geom_linerange(color = "blue") +
  geom_hline(yintercept = record_high_temperature, linetype = "dashed", color = "red") +
  geom_point(data = df[df$Date == record_high_date, ], aes(shape = "Record High"), size = 3, color = "red") +
  geom_text(data = data.frame(Date = rep(df$Date[1], length(record_values)), RecordValue = record_values),
            aes(x = Date, y = RecordValue, label = paste("Record:", RecordValue), vjust = -0.5), color = "green", size = 3) +  # Text label for record values
  scale_shape_manual(values = 17) +
  theme_minimal() +
  labs(title = "Temperature Trend",
       subtitle = paste("Record High on", format(record_high_date, "%B %d, %Y")),
       x = "Date",
       y = "Custom Y-Axis Label") +
  scale_y_continuous(breaks = c(0, 20, 40))  # Set your custom y-axis breaks here"


Keep in mind that the use of AI has a [huge energy cost](https://lmyint.github.io/212_spring_2024/syllabus.html#artificial-intelligence-ai-use). Please describe an energy-saving activity that you can start engaging in to offset this cost.

**Energy-saving activity:** 






